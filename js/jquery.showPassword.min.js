/* jQuery showPassword Plugin
 * 
 * This plugin will add a checkbox element to any specified password input element, which will, when checked show the password that
 * was typed into the input box, or hide it on uncheck. You can specify the text for the checkbox as well as the position of the checkbox 
 * as well as specify a class for the checkbox.
 *
 * @author Byron Rode
 * @website http://www.thecreativefoundation.com/jquery/showPassword
 * @version 1.0
 * @tag inputs, forms, password, useability
 * @requires jQuery v1.3.2 or later
 *
 */

(function($){
	$.fn.showPassword = function(ph, options){
	
		var spinput = $(this);
		
		$.fn.showPassword.checker = function(cbid, inid){
			$('input[id="'+cbid+'"]').click(function(){
				if($(this).attr('checked')){
					$('input.'+inid).val(spinput.val());
					$('input.'+inid).css('display', 'inline');
					spinput.css('display', 'none');
				}else{
					spinput.val($('input.'+inid).val());
					spinput.css('display', 'inline');
					$('input.'+inid).css('display', 'none');
				}
			});
		}
		
		return this.each(function(){
			var defaults = { class: '', name: 'password-input', text: 'Show Password' };
			var spcbid = 'spcb_' + parseInt(Math.random() * 1000);
			var spinid = spcbid.replace('spcb_', 'spin_');
			if (spinput.attr('class') !== '') { var spclass = spinid+' '+spinput.attr('class'); }else{ var spclass = spinid; }
			if(typeof ph == 'object'){ $.extend(defaults, ph); }
			if(typeof options == 'object'){ $.extend(defaults, options); }
			var spname = defaults.name;
			// define the class name of the object
			if(defaults.class==''){ theclass=''; }else{ theclass=' class="'+defaults.class+'"'; }
			// build the checkbox
			$(this).before('<input type="text" id="'+spinput.attr('id')+'" value="" class="'+spclass+'" name="'+spinput.attr('name')+'" style="display: none;" />');
			var thecheckbox = '<input'+theclass+' type="checkbox" id="'+spcbid+'" name="'+spname+'" value="sp" />'+defaults.text;
			
			// check if there is a request to place the checkbox in a specific placeholder. 
			// if not, place directly after the input.
			if(ph == 'object' || typeof ph == 'undefined'){ $(this).after(thecheckbox); }else{ $(ph).html(thecheckbox); }
			$.fn.showPassword.checker(spcbid, spinid);
			return this;
		});
	}
})
(jQuery);